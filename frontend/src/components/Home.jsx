import React, {useEffect, useState} from 'react';
import {useDispatch, useSelector} from "react-redux";

import {findAllBugServer} from "../controller/Redux/bugSlice";
import {handleSidenavOpen} from "./BugsPage";
import SideNavbar from "./SideNavbar";
import DashboardStateCard from "./DashboardStateCard";
import {bugSeverity, bugStatus} from "./CreateBug";


function handleSidenavCloseDashboardPage() {
    document.getElementById('n-nav').style.marginLeft = "70px";
}

function handleSidenavOpenDashboardPage() {
    document.getElementById('n-nav').style.marginLeft = "21vw";
}

export default function DashboardPage() {


    const {allBugs} = useSelector((store) => store.bug)
    const dispatch = useDispatch()


    let updater = {
        open: 0,
        toBeTested: 0,
        inProgress: 0,
        closed: 0,
        minor: 0,
        major: 0,
        critical: 0,
        showStopper: 0
    }





    const [counts, setCounts] = useState({
        open: 0,
        toBeTested: 0,
        inProgress: 0,
        closed: 0,
        minor: 0,
        major: 0,
        critical: 0,
        showStopper: 0
    })


    // setCounts(updater);

    // useEffect()


    // function cardMapper(data) {
    //     return(
    //         <DashboardStateCard
    //             props={counts}
    //         />
    //     )
    // }

    useEffect(() => {
        dispatch(findAllBugServer());
        // for (let bug in allBugs) {
        //     updater[bug.status] += 1
        //     updater[bug.severity] += 1
        // }
        // setCounts(updater)
        // console.log(updater)
        console.log(allBugs)
        handleSidenavOpenDashboardPage();
        handleSidenavOpen();
    }, [dispatch])

    function mapper(data){
        console.log(allBugs)
        setCounts({...counts, open: 2})
    }

    console.log(updater, allBugs)

    for (let bug in allBugs){

    }

    return (
        <div>
            <SideNavbar
                open={handleSidenavOpenDashboardPage}
                close={handleSidenavCloseDashboardPage}
            />
            <div className={"not-nav"} id={"n-nav"}>
                <>
                    <div className={"bug-card"} style={{
                        position: "sticky",
                        top: '0',
                        left: '0',
                        zIndex: "5",
                        backgroundColor: '#FFFEFE',
                        borderRadius: '10px',
                        boxShadow: '0 3px 10px rgb(0 0 0 / 0.2)'
                    }}>
                        <div className={"b-title"}>
                            Dashboard
                        </div>
                        <div className={"empty"}/>
                        <div className={"b-assignee"} style={{paddingLeft: '0.75%'}}>
                            {/*REPORTER*/}
                        </div>
                        <div className={"b-created"} style={{paddingLeft: '0.75%'}}>
                            {/*CREATED*/}
                        </div>
                        <div className={"b-due"} style={{paddingLeft: '0.75%'}}>
                            {/*DUE*/}
                        </div>
                        <div className={"b-status"} style={{paddingLeft: '0.75%'}}>
                            {/*STATUS*/}
                        </div>
                        <div className={"b-assigned"} style={{paddingLeft: '0.75%'}}>
                            {/*ASSIGNEE*/}
                        </div>
                        <div className={"b-severity"} style={{paddingLeft: '0.75%'}}>
                            <button>Log Out</button>
                        </div>
                    </div>
                </>
                <>
                    {allBugs.map(mapper)}
                    <div className={'dash-card-mega-cont'}>
                        <div className={"dash-card-status"}>
                            <DashboardStateCard name={"Open"} count={counts.open} begin={"rgb(255,190,215)"}
                                                end={"rgb(255,224,232)"}
                                                img={
                                                    <svg xmlns="http://www.w3.org/2000/svg"
                                                         viewBox="0 0 512 512">
                                                        <path
                                                            d="M352 96V99.56C352 115.3 339.3 128 323.6 128H188.4C172.7 128 159.1 115.3 159.1 99.56V96C159.1 42.98 202.1 0 255.1 0C309 0 352 42.98 352 96zM41.37 105.4C53.87 92.88 74.13 92.88 86.63 105.4L150.6 169.4C151.3 170 151.9 170.7 152.5 171.4C166.8 164.1 182.9 160 199.1 160H312C329.1 160 345.2 164.1 359.5 171.4C360.1 170.7 360.7 170 361.4 169.4L425.4 105.4C437.9 92.88 458.1 92.88 470.6 105.4C483.1 117.9 483.1 138.1 470.6 150.6L406.6 214.6C405.1 215.3 405.3 215.9 404.6 216.5C410.7 228.5 414.6 241.9 415.7 256H480C497.7 256 512 270.3 512 288C512 305.7 497.7 320 480 320H416C416 344.6 410.5 367.8 400.6 388.6C402.7 389.9 404.8 391.5 406.6 393.4L470.6 457.4C483.1 469.9 483.1 490.1 470.6 502.6C458.1 515.1 437.9 515.1 425.4 502.6L362.3 439.6C337.8 461.4 306.5 475.8 272 479.2V240C272 231.2 264.8 224 255.1 224C247.2 224 239.1 231.2 239.1 240V479.2C205.5 475.8 174.2 461.4 149.7 439.6L86.63 502.6C74.13 515.1 53.87 515.1 41.37 502.6C28.88 490.1 28.88 469.9 41.37 457.4L105.4 393.4C107.2 391.5 109.3 389.9 111.4 388.6C101.5 367.8 96 344.6 96 320H32C14.33 320 0 305.7 0 288C0 270.3 14.33 256 32 256H96.3C97.38 241.9 101.3 228.5 107.4 216.5C106.7 215.9 106 215.3 105.4 214.6L41.37 150.6C28.88 138.1 28.88 117.9 41.37 105.4H41.37z"/>
                                                    </svg>
                                                }
                            />
                            <DashboardStateCard name={"To Be Tested"} count={counts.toBeTested}
                                                begin={"rgb(255,190,215)"}
                                                end={"rgb(255,224,232)"}
                                                img={<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512">
                                                    <path
                                                        d="M160 442.5C149.1 446.1 139.2 448 128 448C74.98 448 32 405 32 352V64C14.33 64 0 49.67 0 32C0 14.33 14.33 0 32 0H224C241.7 0 256 14.33 256 32C256 49.67 241.7 64 224 64V309.9L175 389.4C165.2 405.4 160 423.8 160 442.5zM96 160H160V64H96V160zM512 0C529.7 0 544 14.33 544 32C544 49.67 529.7 64 512 64V214.9L629.7 406.2C636.4 417.2 640 429.7 640 442.6C640 480.9 608.9 512 570.6 512H261.4C223.1 512 191.1 480.9 191.1 442.6C191.1 429.7 195.6 417.2 202.3 406.2L319.1 214.9V64C302.3 64 287.1 49.67 287.1 32C287.1 14.33 302.3 0 319.1 0L512 0zM384 64V224C384 229.9 382.4 235.7 379.3 240.8L330.5 320H501.5L452.7 240.8C449.6 235.7 448 229.9 448 224V64H384z"/>
                                                </svg>}/>
                            <DashboardStateCard name={"In Progress"} count={counts.inProgress}
                                                begin={"rgb(255,190,215)"}
                                                end={"rgb(255,224,232)"} img={<svg xmlns="http://www.w3.org/2000/svg"
                                                                                   viewBox="0 0 512 512">
                                <path
                                    d="M152.1 38.16C161.9 47.03 162.7 62.2 153.8 72.06L81.84 152.1C77.43 156.9 71.21 159.8 64.63 159.1C58.05 160.2 51.69 157.6 47.03 152.1L7.029 112.1C-2.343 103.6-2.343 88.4 7.029 79.03C16.4 69.66 31.6 69.66 40.97 79.03L63.08 101.1L118.2 39.94C127 30.09 142.2 29.29 152.1 38.16V38.16zM152.1 198.2C161.9 207 162.7 222.2 153.8 232.1L81.84 312.1C77.43 316.9 71.21 319.8 64.63 319.1C58.05 320.2 51.69 317.6 47.03 312.1L7.029 272.1C-2.343 263.6-2.343 248.4 7.029 239C16.4 229.7 31.6 229.7 40.97 239L63.08 261.1L118.2 199.9C127 190.1 142.2 189.3 152.1 198.2V198.2zM224 96C224 78.33 238.3 64 256 64H480C497.7 64 512 78.33 512 96C512 113.7 497.7 128 480 128H256C238.3 128 224 113.7 224 96V96zM224 256C224 238.3 238.3 224 256 224H480C497.7 224 512 238.3 512 256C512 273.7 497.7 288 480 288H256C238.3 288 224 273.7 224 256zM160 416C160 398.3 174.3 384 192 384H480C497.7 384 512 398.3 512 416C512 433.7 497.7 448 480 448H192C174.3 448 160 433.7 160 416zM0 416C0 389.5 21.49 368 48 368C74.51 368 96 389.5 96 416C96 442.5 74.51 464 48 464C21.49 464 0 442.5 0 416z"/>
                            </svg>}/>
                            <DashboardStateCard name={"Closed"} count={counts.closed} begin={"rgb(255,190,215)"}
                                                end={"rgb(255,224,232)"}
                                                img={<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512">
                                                    <path
                                                        d="M239.1 162.8C247.7 160.1 255.7 160 264 160H376C393.1 160 409.2 164.1 423.5 171.4C424.1 170.7 424.7 170 425.4 169.4L489.4 105.4C501.9 92.88 522.1 92.88 534.6 105.4C547.1 117.9 547.1 138.1 534.6 150.6L470.6 214.6C469.1 215.3 469.3 215.9 468.6 216.5C474.7 228.5 478.6 241.9 479.7 256H544C561.7 256 576 270.3 576 288C576 305.7 561.7 320 544 320H480C480 329.9 479.1 339.5 477.4 348.9L630.8 469.1C641.2 477.3 643.1 492.4 634.9 502.8C626.7 513.2 611.6 515.1 601.2 506.9L9.196 42.89C-1.236 34.71-3.065 19.63 5.112 9.196C13.29-1.236 28.37-3.065 38.81 5.112L239.1 162.8zM416 96V99.56C416 115.3 403.3 128 387.6 128H252.4C236.7 128 224 115.3 224 99.56V96C224 42.98 266.1 .001 320 .001C373 .001 416 42.98 416 96V96zM160.3 256C161.1 245.1 163.3 236.3 166.7 227.3L304 335.5V479.2C269.5 475.8 238.2 461.4 213.7 439.6L150.6 502.6C138.1 515.1 117.9 515.1 105.4 502.6C92.88 490.1 92.88 469.9 105.4 457.4L169.4 393.4C171.2 391.5 173.3 389.9 175.4 388.6C165.5 367.8 160 344.6 160 320H96C78.33 320 64 305.7 64 288C64 270.3 78.33 256 96 256H160.3zM336 479.2V360.7L430.8 435.4C405.7 459.6 372.7 475.6 336 479.2V479.2z"/>
                                                </svg>
                                                }/>
                        </div>
                        <div className={"dash-card-severity"}>
                            <DashboardStateCard name={"Minor"} count={counts.minor} begin={"rgb(139,200,255)"}
                                                end={"rgb(201,228,255)"}
                                                img={<svg xmlns="http://www.w3.org/2000/svg"
                                                          viewBox="0 0 640 512">
                                                    <path
                                                        d="M480 96H576C611.3 96 640 124.7 640 160V352C640 387.3 611.3 416 576 416H480V96zM448 416H192V96H448V416zM272 184C258.7 184 248 194.7 248 208C248 221.3 258.7 232 272 232C285.3 232 296 221.3 296 208C296 194.7 285.3 184 272 184zM368 232C381.3 232 392 221.3 392 208C392 194.7 381.3 184 368 184C354.7 184 344 194.7 344 208C344 221.3 354.7 232 368 232zM272 280C258.7 280 248 290.7 248 304C248 317.3 258.7 328 272 328C285.3 328 296 317.3 296 304C296 290.7 285.3 280 272 280zM368 328C381.3 328 392 317.3 392 304C392 290.7 381.3 280 368 280C354.7 280 344 290.7 344 304C344 317.3 354.7 328 368 328zM64 96H160V416H64C28.65 416 0 387.3 0 352V160C0 124.7 28.65 96 64 96z"/>
                                                </svg>
                                                }/>
                            <DashboardStateCard name={"Major"} count={counts.major} begin={"rgb(139,200,255)"}
                                                end={"rgb(201,228,255)"}
                                                img={<svg xmlns="http://www.w3.org/2000/svg"
                                                          viewBox="0 0 384 512">
                                                    <path
                                                        d="M240.5 224H352C365.3 224 377.3 232.3 381.1 244.7C386.6 257.2 383.1 271.3 373.1 280.1L117.1 504.1C105.8 513.9 89.27 514.7 77.19 505.9C65.1 497.1 60.7 481.1 66.59 467.4L143.5 288H31.1C18.67 288 6.733 279.7 2.044 267.3C-2.645 254.8 .8944 240.7 10.93 231.9L266.9 7.918C278.2-1.92 294.7-2.669 306.8 6.114C318.9 14.9 323.3 30.87 317.4 44.61L240.5 224z"/>
                                                </svg>}/>
                            <DashboardStateCard name={"Critical"} count={counts.critical} begin={"rgb(139,200,255)"}
                                                end={"rgb(201,228,255)"} img={<svg xmlns="http://www.w3.org/2000/svg"
                                                                                   viewBox="0 0 576 512">
                                <path
                                    d="M575.5 283.5c-13.13-39.11-39.5-71.98-74.13-92.35c-17.5-10.37-36.25-16.62-55.25-19.87c6-17.75 10-36.49 10-56.24c0-40.99-14.5-80.73-41-112.2c-2.5-3-6.625-3.623-10-1.75c-3.25 1.875-4.75 5.998-3.625 9.748c4.5 13.75 6.625 26.24 6.625 38.49c0 67.73-53.76 122.8-120 122.8s-120-55.11-120-122.8c0-12.12 2.25-24.74 6.625-38.49c1.125-3.75-.375-7.873-3.625-9.748c-3.375-1.873-7.502-1.25-10 1.75C134.7 34.3 120.1 74.04 120.1 115c0 19.75 3.875 38.49 10 56.24C111.2 174.5 92.32 180.8 74.82 191.1c-34.63 20.49-61.01 53.24-74.38 92.35c-1.25 3.75 .25 7.748 3.5 9.748c3.375 2 7.5 1.375 10-1.5c9.377-10.87 19-19.12 29.25-25.12c57.25-33.87 130.8-13.75 163.9 44.99c33.13 58.61 13.38 133.1-43.88 167.8c-10.25 6.123-22 10.37-35.88 13.37c-3.627 .875-6.377 4.25-6.377 8.123c.125 4 2.75 7.248 6.502 7.998c39.75 7.748 80.63 .7495 115.3-19.74c18-10.5 32.88-24.49 45.25-39.99c12.38 15.5 27.38 29.49 45.38 39.99c34.5 20.49 75.51 27.49 115.1 19.74c3.875-.75 6.375-3.998 6.5-7.998c0-3.873-2.625-7.248-6.375-8.123c-13.88-2.873-25.63-7.248-35.75-13.37c-57.38-33.87-77.01-109.2-44-167.8c33.13-58.73 106.6-78.85 164-44.99c10.12 6.123 19.75 14.25 29.13 25.12c2.5 2.875 6.752 3.5 10 1.5C575.4 291.2 576.9 287.2 575.5 283.5zM287.1 320.1c-26.5 0-48-21.49-48-47.99c0-26.49 21.5-47.99 48-47.99c26.5 0 48.01 21.49 48.01 47.99C335.1 298.6 314.5 320.1 287.1 320.1zM385 377.6c1.152 22.77 10.74 44.63 27.22 60.92c47.45-35.44 79.13-90.58 83.1-153.4c-22.58-6.173-45.69-2.743-65.57 8.76C424.7 326.9 408.5 355.1 385 377.6zM253.3 132.6c26.22-6.551 45.37-6.024 69.52 .0254c21.93-9.777 39.07-28.55 47.48-51.75C345 69.98 317.3 63.94 288.1 63.94c-29.18 0-56.96 5.986-82.16 16.84C214.3 103.1 231.4 122.8 253.3 132.6zM163.8 438.5c16.46-16.26 26.03-38.19 27.14-61.01c-23.49-21.59-39.59-50.67-44.71-83.6C126.9 282.7 103.8 278.8 80.67 285.1C84.64 347.9 116.3 403.1 163.8 438.5z"/>
                            </svg>}/>
                            <DashboardStateCard name={"Show Stopper"} count={counts.showStopper}
                                                begin={"rgb(139,200,255)"}
                                                end={"rgb(201,228,255)"} img={<svg xmlns="http://www.w3.org/2000/svg"
                                                                                   viewBox="0 0 512 512">
                                <path
                                    d="M256 303.1c26.5 0 48-21.5 48-48S282.5 207.1 256 207.1S208 229.5 208 255.1S229.5 303.1 256 303.1zM213.6 188L142.7 74.71C132.5 58.41 109.9 54.31 95.25 66.75c-44.94 38.1-76.19 91.82-85.17 152.8C7.266 238.7 22.67 255.8 42.01 255.8h133.8C175.8 227.2 191 202.3 213.6 188zM416.8 66.75c-14.67-12.44-37.21-8.338-47.41 7.965L298.4 188c22.6 14.3 37.8 39.2 37.8 67.8h133.8c19.34 0 34.74-17.13 31.93-36.26C492.9 158.6 461.7 104.8 416.8 66.75zM298.4 323.5C286.1 331.2 271.6 335.9 256 335.9s-30.1-4.701-42.4-12.4L142.7 436.9c-10.14 16.21-4.16 38.2 13.32 45.95C186.6 496.4 220.4 504 256 504s69.42-7.611 100-21.18c17.48-7.752 23.46-29.74 13.32-45.95L298.4 323.5z"/>
                            </svg>}/>
                        </div>
                    </div>
                </>
            </div>
        </div>
    )
}
